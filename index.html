<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∫—Ä—É—Ç–∫–∏ VK</title>
    <!-- SheetJS –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ XLSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/fase.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∫—Ä—É—Ç–∫–∏ –ª–∞–π–∫–æ–≤ VK</h1>
        <p>
          –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Å—Ç–∞–≤–∏–≤—à–∏—Ö –ª–∞–π–∫–∏ —Å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ —Å–ø–∏—Å–∫—É
          –¥—Ä—É–∑–µ–π –∏ —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ Excel
        </p>
      </div>

      <div class="main-content">
        <!-- –°–µ–∫—Ü–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ–≤–æ–º –º–µ—Ç–æ–¥–µ -->
        <div class="friend-check-section">
          <h3>üìã –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∞–π–∫–æ–≤ –æ—Ç –¥—Ä—É–∑–µ–π</h3>
          <div class="friend-explanation">
            <strong>üöÄ –ë–µ–∑ API-–∑–∞–ø—Ä–æ—Å–æ–≤!</strong> –¢–µ–ø–µ—Ä—å –≤—ã –∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ –≥–æ—Ç–æ–≤—ã–π
            —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ, –∏ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç
            –ª–∞–π–∫–µ—Ä–æ–≤ –ø–æ ID. –≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ VK API.<br /><br />
            <strong>–ê–ª–≥–æ—Ä–∏—Ç–º:</strong> –°–ø–∏—Å–æ–∫ –ª–∞–π–∫–µ—Ä–æ–≤ ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ ID ‚Üí
            –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –¥—Ä—É–∑–µ–π ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç<br /><br />
            <strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π:</strong><br />
            ‚Ä¢ <span style="color: #28a745">profile_url,name,type</span> -
            —ç–∫—Å–ø–æ—Ä—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤/–¥—Ä—É–∑–µ–π –∏–∑ VK<br />
            ‚Ä¢
            <span style="color: #28a745">https://vk.com/id123,"–ò–º—è","—Ç–∏–ø"</span>
            - URL —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏<br />
            ‚Ä¢ <span style="color: #28a745">123456,–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</span> - –ø—Ä–æ—Å—Ç–æ–π
            —Ñ–æ—Ä–º–∞—Ç ID + –∏–º—è<br />
            ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –∏–∑ –ª—é–±—ã—Ö VK URL
          </div>
        </div>

        <div class="upload-section">
          <h3>üìÅ 1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª —Å –ª–∞–π–∫–µ—Ä–∞–º–∏</h3>
          <p>
            –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:<br />
            ‚Ä¢ <strong>profile_url</strong> - —Å—Å—ã–ª–∫–∏ –≤–∏–¥–∞ https://vk.com/id123
            –∏–ª–∏ https://vk.com/username<br />
            ‚Ä¢ <strong>id/user_id</strong> - –ø—Ä—è–º—ã–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Å—Ç–∞–≤–∏–≤—à–∏—Ö
            –ª–∞–π–∫<br />
            ‚Ä¢ <strong>name</strong> - –∏–º–µ–Ω–∞ –ª–∞–π–∫–µ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
          </p>
          <input type="file" id="csvFile" class="file-input" accept=".csv" />
          <button
            class="upload-btn"
            onclick="document.getElementById('csvFile').click()"
          >
            –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª —Å –ª–∞–π–∫–∞–º–∏
          </button>
          <div class="file-status" id="mainFileStatus"></div>
        </div>

        <!-- –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π -->
        <div
          class="upload-section"
          style="background: #e8f5e8; border-color: #28a745"
        >
          <h3>üë• 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ CSV —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –¥—Ä—É–∑–µ–π</h3>
          <p>
            –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:<br />
            ‚Ä¢ <strong>–° –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:</strong> profile_url,name,type
            (–∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤)<br />
            ‚Ä¢ <strong>–ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:</strong> –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü - URL/ID, –≤—Ç–æ—Ä–æ–π -
            –∏–º—è<br />
            ‚Ä¢ <strong>–ü—Ä–∏–º–µ—Ä—ã:</strong><br />
            &nbsp;&nbsp;- https://vk.com/id123456,"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤","friend"<br />
            &nbsp;&nbsp;- vk.com/username,"–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤","subscriber"<br />
            &nbsp;&nbsp;- 123456,–ò–º—è –§–∞–º–∏–ª–∏—è
          </p>
          <input
            type="file"
            id="friendsFile"
            class="file-input"
            accept=".csv"
          />
          <button
            class="upload-btn friends"
            onclick="document.getElementById('friendsFile').click()"
            style="background: #28a745"
          >
            –í—ã–±—Ä–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π
          </button>
          <div class="file-status" id="friendsFileStatus"></div>
          <p>
            <small style="color: #666">
              üí° –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Ñ–æ—Ä–º–∞—Ç –∏ –∏–∑–≤–ª–µ—á–µ—Ç ID –∏–∑ URL VK
            </small>
          </p>
        </div>

        <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="controls-section" id="controlsSection">
          <h3>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º</h3>

          <div class="controls-grid">
            <div class="control-group">
              <label>–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:</label>
              <select id="groupBySelect">
                <option value="city">–ü–æ –≥–æ—Ä–æ–¥—É</option>
                <option value="profile_status">–ü–æ —Å—Ç–∞—Ç—É—Å—É –ø—Ä–æ—Ñ–∏–ª—è</option>
                <option value="friend_status">–ü–æ —Å—Ç–∞—Ç—É—Å—É –¥—Ä—É–∂–±—ã</option>
                <option value="none">–ë–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏</option>
              </select>
            </div>

            <div class="control-group">
              <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
              <select id="sortBySelect">
                <option value="first_name">–ü–æ –∏–º–µ–Ω–∏</option>
                <option value="last_name">–ü–æ —Ñ–∞–º–∏–ª–∏–∏</option>
                <option value="online">–ü–æ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å—É</option>
                <option value="city">–ü–æ –≥–æ—Ä–æ–¥—É</option>
                <option value="id">–ü–æ ID</option>
                <option value="profile_status">–ü–æ —Å—Ç–∞—Ç—É—Å—É –ø—Ä–æ—Ñ–∏–ª—è</option>
                <option value="friend_status">–ü–æ —Å—Ç–∞—Ç—É—Å—É –¥—Ä—É–∂–±—ã</option>
              </select>
            </div>

            <div class="control-group">
              <label>–ü–æ—Ä—è–¥–æ–∫:</label>
              <select id="sortOrderSelect">
                <option value="asc">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                <option value="desc">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
              </select>
            </div>

            <div class="control-group">
              <label>–ü–æ–∏—Å–∫:</label>
              <input
                type="text"
                id="searchInput"
                class="search-input"
                placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, –≥–æ—Ä–æ–¥—É..."
              />
            </div>
          </div>

          <div class="view-toggle">
            <button
              class="view-btn active"
              id="cardViewBtn"
              onclick="switchView('cards')"
            >
              üÉè –ö–∞—Ä—Ç–æ—á–∫–∏
            </button>
            <button
              class="view-btn"
              id="tableViewBtn"
              onclick="switchView('table')"
            >
              üìä –¢–∞–±–ª–∏—Ü–∞
            </button>
          </div>
        </div>

        <div class="rate-limit-warning">
          ‚úÖ <strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞:</strong><br />
          üöÄ <strong>–ë–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:</strong> –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–µ–Ω—ã API-–∑–∞–ø—Ä–æ—Å—ã –∫
          VK<br />
          ‚ö° <strong>–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:</strong> –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ
          ID<br />
          üõ°Ô∏è <strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π VK API<br />
          üìä <strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> —Ä–∞–±–æ—Ç–∞ —Å –≤–∞—à–∏–º–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        </div>

        <div class="progress-container" id="progressContainer">
          <p>–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <span id="progressText">0/0</span></p>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <div class="stats-container" id="statsContainer" style="display: none">
          <div class="stat-card">
            <div class="stat-number" id="totalUsers">0</div>
            <div class="stat-label">–í—Å–µ–≥–æ –ª–∞–π–∫–æ–≤</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="processedUsers">0</div>
            <div class="stat-label">–õ–∞–π–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="uniqueCities">0</div>
            <div class="stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="openProfiles">0</div>
            <div class="stat-label">–û—Ç–∫—Ä—ã—Ç—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="friendsInLikes">0</div>
            <div class="stat-label">–î—Ä—É–∑–µ–π —Å—Ä–µ–¥–∏ –ª–∞–π–∫–µ—Ä–æ–≤</div>
          </div>
        </div>

        <div class="status" id="status" style="display: none"></div>

        <!-- –ö–∞—Ä—Ç–æ—á–Ω—ã–π —Ä–µ–∂–∏–º -->
        <div class="results-container" id="resultsContainer"></div>

        <!-- –¢–∞–±–ª–∏—á–Ω—ã–π —Ä–µ–∂–∏–º -->
        <div class="table-container" id="tableContainer">
          <table class="results-table" id="resultsTable">
            <thead>
              <tr>
                <th onclick="sortTable('avatar')">–§–æ—Ç–æ</th>
                <th onclick="sortTable('name')">
                  –ò–º—è <span class="sort-indicator">‚Üï</span>
                </th>
                <th onclick="sortTable('id')">
                  ID <span class="sort-indicator">‚Üï</span>
                </th>
                <th onclick="sortTable('online')">
                  –°—Ç–∞—Ç—É—Å <span class="sort-indicator">‚Üï</span>
                </th>
                <th onclick="sortTable('city')">
                  –ì–æ—Ä–æ–¥ <span class="sort-indicator">‚Üï</span>
                </th>
                <th onclick="sortTable('profile_status')">
                  –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å <span class="sort-indicator">‚Üï</span>
                </th>
                <th onclick="sortTable('friend_status')">
                  –î—Ä—É–∂–±–∞ <span class="sort-indicator">‚Üï</span>
                </th>
              </tr>
            </thead>
            <tbody id="resultsTableBody"></tbody>
          </table>
        </div>

        <div class="export-buttons" id="exportButtons">
          <button class="export-btn" onclick="exportResults('csv')">
            üìÑ –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
          </button>
          <button class="export-btn xlsx" onclick="exportResults('xlsx')">
            üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
          </button>
        </div>

        <div class="analytics-section" id="analyticsSection">
          <h2>üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ª–∞–π–∫–æ–≤</h2>
          <div class="analytics-grid">
            <div class="analytics-card">
              <h3>üèôÔ∏è –õ–∞–π–∫–µ—Ä—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º</h3>
              <div id="cityStats"></div>
            </div>
            <div class="analytics-card">
              <h3>üîí –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ñ–∏–ª–µ–π –ª–∞–π–∫–µ—Ä–æ–≤</h3>
              <div id="profileStats"></div>
            </div>
            <div class="analytics-card">
              <h3>üë• –î—Ä—É–∑—å—è —Å—Ä–µ–¥–∏ –ª–∞–π–∫–µ—Ä–æ–≤</h3>
              <div id="friendshipStats"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="js/basefunc.js"></script>
  </body>
</html>
